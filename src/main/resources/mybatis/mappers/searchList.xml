<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="searchList">
		
		<select id="selectSearchList" parameterType="SearchListVo" resultType="SearchListVo">
				<![CDATA[
				  select  h.hostNo,
				          u.name hostName,
				          u.path path,
						  h.adress1 adress1,
						  h.adress3 adress3,
						  h.x x,
						  h.y x,
						  trunc(c.rp,1) reviewPoint,
						  trunc(c.pp,1) puppyPoint,
				          trunc(c.clean,1) clean,
				          trunc(c.walk,1) walk,
				          trunc(c.play,1) play,
				          trunc(c.food,1) food,
				          trunc(c.communication,1) communication,
                          c.review review
				  from    users u, host h, (select  count(review) rp,   count(review) review,
                                                                        ((avg(clean) + avg(walk) + avg(play) + avg(food) + avg(communication))/5) pp,
				                                                        avg(clean) clean,
				                                                        avg(walk) walk,
				                                                        avg(play) play,
				                                                        avg(food) food,
				                                                        avg(communication) communication        
				                                                 from   booking ) c                 
				  where u.usersNo = h.usersNo
				  ]]>	
				  <include refid="search"></include>
				  
		</select>
	  	
		<sql id="search">
				<if test="searchKeyword != null and searchKeyword != ''.toString()">
						and
					<if test="searchKeyword.toString()">
						adress1 like '%' || #{searchKeyword} || '%'
					</if>
				</if>
		</sql>

</mapper>